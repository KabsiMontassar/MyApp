<!-- Plant Disease Detection Widget Button -->
<div class="plant-disease-widget">
  <button class="widget-btn" (click)="openModal()">
    <i class="fa fa-leaf"></i>
    Detect Plant Diseases
  </button>
</div>

<!-- Modal Dialog for Plant Disease Detection -->
<div class="modal-backdrop" *ngIf="isModalOpen" (click)="closeModal()"></div>
<div class="detection-modal" *ngIf="isModalOpen">
  <div class="modal-header">
    <h3>Plant Disease Detection</h3>
    <button class="close-btn" (click)="closeModal()">&times;</button>
  </div>
  
  <div class="modal-body">
   
    
    <div class="upload-section">
      <p>Upload an image of a plant leaf to detect diseases</p>
      
      <div class="image-upload-area" (click)="triggerFileInput()" [class.has-image]="imageUrl" [class.disabled]="!isServerRunning && !useDemoMode">
        <input #fileInput type="file" accept="image/jpeg,image/png,image/jpg" (change)="onFileSelected($event)" hidden />
        
        <div *ngIf="!imageUrl" class="upload-placeholder">
          <i class="fa fa-cloud-upload"></i>
          <p>Click to select an image</p>
          <small class="text-muted">Supported formats: JPG, PNG</small>
        </div>
        
        <img *ngIf="imageUrl" [src]="imageUrl" alt="Selected plant image" />
      </div>
      
      <button class="primary-btn detect-btn" (click)="detectDisease()" [disabled]="!selectedFile || isLoading || (!isServerRunning && !useDemoMode)">
        <span *ngIf="!isLoading">Detect Disease</span>
        <span *ngIf="isLoading">Processing...</span>
      </button>
    </div>
    
    <div class="results-section" *ngIf="predictionResult">
      <h4>Results:</h4>
      <div class="result-content" [innerHTML]="predictionResult"></div>
    </div>
    
    <div class="error-message" *ngIf="errorMessage">
      <i class="fa fa-exclamation-circle"></i> {{ errorMessage }}
      <div *ngIf="errorMessage?.includes('server is not running')" class="server-instructions">
        <p>To start the plant disease detection server:</p>
        <ol>
          <li>Open a terminal or command prompt</li>
          <li>Navigate to the project directory: <code>cd src/Plant-Disease-Detection-main</code></li>
          <li>Run the server: <code>python api_server.py</code></li>
        </ol>
      </div>
    </div>
  </div>
</div>
